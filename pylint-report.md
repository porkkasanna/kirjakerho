# Pylint-raportti

Pylint antaa seuraavan raportin sovelluksesta:

```
************* Module app
app.py:1:0: C0114: Missing module docstring (missing-module-docstring)
app.py:20:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:24:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:29:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:33:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:37:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:40:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:44:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:51:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:69:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:93:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:97:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:126:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:149:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:164:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:191:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:210:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:220:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:220:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:241:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:249:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:249:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:282:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:307:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:328:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:328:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:368:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:368:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:391:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:410:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:431:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:451:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:451:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:479:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:479:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
************* Module clubs
clubs.py:1:0: C0114: Missing module docstring (missing-module-docstring)
clubs.py:4:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:20:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:35:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:48:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:53:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:65:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:79:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:83:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:105:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:136:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:153:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:168:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:173:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:178:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:184:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:188:0: C0116: Missing function or method docstring (missing-function-docstring)
clubs.py:200:0: C0116: Missing function or method docstring (missing-function-docstring)
************* Module config
config.py:1:0: C0114: Missing module docstring (missing-module-docstring)
config.py:1:0: C0103: Constant name "secret_key" doesn't conform to UPPER_CASE naming style (invalid-name)
************* Module db
db.py:1:0: C0114: Missing module docstring (missing-module-docstring)
db.py:4:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:10:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:10:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
db.py:17:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:20:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:20:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
************* Module seed
seed.py:1:0: C0114: Missing module docstring (missing-module-docstring)
seed.py:12:0: C0103: Constant name "user_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:13:0: C0103: Constant name "club_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:14:0: C0103: Constant name "review_count" doesn't conform to UPPER_CASE naming style (invalid-name)
************* Module users
users.py:1:0: C0114: Missing module docstring (missing-module-docstring)
users.py:4:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:18:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:25:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:41:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:46:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:66:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:80:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:85:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:89:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:94:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:98:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:1:0: R0801: Similar lines in 2 files
==clubs:[136:145]
==users:[66:75]
    sql = """SELECT
                r.id,
                r.stars,
                r.content,
                r.sent_at,
                r.modified_at,
                r.user_id,
                u.username
             FROM reviews r, users u (duplicate-code)
users.py:1:0: R0801: Similar lines in 2 files
==clubs:[153:159]
==users:[66:72]
    sql = """SELECT
                r.id,
                r.stars,
                r.content,
                r.sent_at,
                r.modified_at, (duplicate-code)

------------------------------------------------------------------
Your code has been rated at 8.60/10 (previous run: 8.60/10, +0.00)
```

## Docstring-ilmoitukset

Raportin ongelmat johtuvat valtaosin puuttuvista docstring-kommenteista, kuten:

```
app.py:1:0: C0114: Missing module docstring (missing-module-docstring)
app.py:20:0: C0116: Missing function or method docstring (missing-function-docstring)
```
Docstring-kommentit on tarkoituksella jätetty pois, sillä se ei ollut vaatimuksena sovelluksen kehittämisessä.

## Puuttuva palautusarvo

Pylint huomauttaa puuttuvista palautusarvoista:

```
app.py:249:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
```

Nämä johtuvat funktioista, jotka käsittelevät sekä `GET` että `POST` -metodeja. Mikäli metodi olisi jokin muu, voisi funktio ajautua tilanteeseen, jossa palautusarvoa ei anneta, mutta koska funktioon pääsee vain tilanteessa, jossa jompi kumpi metodeista on käytössä, ei tällaiseen tilanteeseen käytännössä koskaan jouduta, eli tämä ei ole ongelma. Esimerkki tällaisesta funktiosta:

```
@app.route("/remove_review/<int:review_id>", methods=["GET", "POST"])
def remove_review(review_id):
    session["return_url"] = None
    require_login()
    review = clubs.get_review(review_id)

    if not review:
        not_found()
    if review["user_id"] != session["user_id"]:
        forbidden()

    if request.method == "GET":
        return render_template("remove_review.html", review=review)

    if request.method == "POST":
        require_login()
        check_csrf()
        if "remove" in request.form:
            clubs.remove_review(review_id)
        return redirect("/bookclub/" + str(review["club_id"]))
```

## Vakioiden nimet

Vakiot `secret_key` ja suuren tietomäärän testaukseen littyvät `user_count`, `club_count` ja `review_count` eivät ole nimetty isoilla kirjaimilla, kuten Pylintin mukaan pitäisi:

```
config.py:1:0: C0103: Constant name "secret_key" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:12:0: C0103: Constant name "user_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:13:0: C0103: Constant name "club_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:14:0: C0103: Constant name "review_count" doesn't conform to UPPER_CASE naming style (invalid-name)
```

Nimet on tietoisesti päätetty jättää pienillä kirjaimilla nimetyiksi.

## Vaarallinen oletusarvo

```
db.py:10:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
db.py:20:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
```

Nämä koskevat tietokantaa käsitteleviä funktioita:

```
def execute(sql, params=[]):
    con = get_connection()
    result = con.execute(sql, params)
    con.commit()
    g.last_insert_id = result.lastrowid
    con.close()

def query(sql, params=[]):
    con = get_connection()
    result = con.execute(sql, params).fetchall()
    con.close()
    return result
```

Tämä voisi olla ongelma, mikäli listaoliota muokattaisiin funktion sisällä, mutta näin ei tapahdu, joten tämä ei ole ongelma.

## Samankaltaiset rivit kahdessa tiedostossa

```
users.py:1:0: R0801: Similar lines in 2 files
==clubs:[136:145]
==users:[66:75]
    sql = """SELECT
                r.id,
                r.stars,
                r.content,
                r.sent_at,
                r.modified_at,
                r.user_id,
                u.username
             FROM reviews r, users u (duplicate-code)

users.py:1:0: R0801: Similar lines in 2 files
==clubs:[153:159]
==users:[66:72]
    sql = """SELECT
                r.id,
                r.stars,
                r.content,
                r.sent_at,
                r.modified_at, (duplicate-code)
```

Kahden tiedoston rivit vaikuttavat keskenään samanlaisilta, mutta ensimmäisessä virheilmoituksessa on kyse kahdesta funktiosta, jossa toisessa haetaan tietokannasta tietyn kirjakerhon kaikkia arvosteluja, ja toisessa tietyn käyttäjän arvostelu tietyssä kirjakerhossa. Toisessa virheilmoituksessa käsitellään myös tietyn käyttäjän arvostelu etsimistä tietyssä kirjakerhossa ja toinen funktio etsii tietyn arvostelun sen muokkaamista varten.